{"version":3,"sources":["../src/header.js"],"names":["Header","inputBuffer","transform","chunk","encoding","cb","content","push","length","header","replace","repeat","shift","flush","obj"],"mappings":";;;;;kBAGwBA,M;;AAHxB;;;;AACA;;;;;;AAEe,SAASA,MAAT,GAAkB;AAC/B,MAAMC,cAAc,EAApB;;AAEA,WAASC,SAAT,CAAmBC,KAAnB,EAA0BC,QAA1B,EAAoCC,EAApC,EAAwC;AACtC,QAAIF,MAAMG,OAAV,EAAmBL,YAAYM,IAAZ,CAAiBJ,KAAjB;;AAEnB;AACA,WAAOF,YAAYO,MAAZ,GAAqB,CAA5B,EAA+B;AAC7B,UAAMC,SAASR,YAAY,CAAZ,EAAeQ,MAA9B;AACA,UAAIH,UAAUL,YAAY,CAAZ,EAAeK,OAA7B;;AAEA,UAAIG,MAAJ,EAAY;AACVH,kBAAU,iBAAEI,OAAF,CACRJ,OADQ,EAER,kBAFQ,SAGH,iBAAEK,MAAF,CAAS,GAAT,EAAcF,MAAd,CAHG,QAAV;AAKAR,oBAAY,CAAZ,EAAeK,OAAf,GAAyBA,OAAzB;AACD;AACD,WAAKC,IAAL,CAAUN,YAAYW,KAAZ,EAAV;AACD;;AAED,WAAOP,IAAP;AACD;;AAED,WAASQ,KAAT,CAAeR,EAAf,EAAmB;AACjB;AACA,QAAIJ,YAAYO,MAAZ,GAAqB,CAAzB,EAA4B,KAAKD,IAAL,CAAUN,YAAYW,KAAZ,EAAV;AAC5B,SAAKL,IAAL,CAAU,IAAV;AACA,WAAOF,IAAP;AACD;;AAED,SAAO,kBAASS,GAAT,CAAaZ,SAAb,EAAwBW,KAAxB,CAAP;AACD","file":"header.js","sourcesContent":["import through2 from 'through2';\nimport _ from 'lodash';\n\nexport default function Header() {\n  const inputBuffer = [];\n\n  function transform(chunk, encoding, cb) {\n    if (chunk.content) inputBuffer.push(chunk);\n\n    // The input buffer shouldn't have more than two items in it at a time\n    while (inputBuffer.length > 1) {\n      const header = inputBuffer[0].header;\n      let content = inputBuffer[0].content;\n\n      if (header) {\n        content = _.replace(\n          content,\n          /^(#+)([^#|\\n]*)/g,\n          `$1${_.repeat('#', header)}$2`\n        );\n        inputBuffer[0].content = content;\n      }\n      this.push(inputBuffer.shift());\n    }\n\n    return cb();\n  }\n\n  function flush(cb) {\n    // Empty internal buffer and signal the end of the output stream.\n    if (inputBuffer.length > 0) this.push(inputBuffer.shift());\n    this.push(null);\n    return cb();\n  }\n\n  return through2.obj(transform, flush);\n}\n"]}